(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-46866c20"],{"0ad8":function(t,e,i){"use strict";var a=i("9066"),s=i.n(a);s.a},"18bf":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"template-list-wrapper project-delete"},[i("i-page-title",{attrs:{title:"最近删除",beforeTitle:"我的项目",createBtnName:"批量操作",iconShow:!1},on:{createAction:function(e){return t.createAction()}}}),i("div",{staticClass:"template-active-list"},[i("pictureTable",{attrs:{ActiveList:t.ActiveList,pagination:t.pagination,batchSelect:t.batchSelect},on:{handleTableChange:t.handleTableChange}})],1),i("el-dialog",{attrs:{visible:t.bigImgShow,width:"40%"},on:{"update:visible":function(e){t.bigImgShow=e}}},[i("div",{staticClass:"text-center"},[i("img",{staticStyle:{width:"100%"},attrs:{src:t.bigImgSrc}})]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.bigImgShow=!1}}},[t._v("关闭")])],1)]),i("el-dialog",{staticClass:"auto-release-dialog",attrs:{visible:t.autoReleaseDialog,width:"20%"},on:{"update:visible":function(e){t.autoReleaseDialog=e}}},[i("div",{staticClass:"text-center"},[i("p",{staticClass:"title"},[t._v("你确定设定自动发布么？设定后"),i("br"),t._v("活动将按照活动有效期，自动上下线")]),i("p",[t._v("活动开始时间："+t._s(this.selectActivity.startTime))]),i("p",[t._v("活动开始时间："+t._s(this.selectActivity.endTime))])]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("div",{staticClass:"btn-orange-plain",on:{click:function(e){t.autoReleaseDialog=!1}}},[i("p",[t._v("取消")])]),i("div",{staticClass:"btn-orange-primary",on:{click:function(e){return t.changeRelease("auto")}}},[i("p",[t._v("确定")])])])]),i("el-dialog",{staticClass:"pre-release-dialog",attrs:{visible:t.preReleaseDialog,width:"20%"},on:{"update:visible":function(e){t.preReleaseDialog=e}}},[i("p",{staticClass:"title"},[t._v("设置预发布信息")]),i("el-form",{ref:"form",staticClass:"text-left",attrs:{model:t.form,rules:t.roles,"label-width":"160px","label-position":"top"}},[i("el-form-item",{attrs:{label:"设置测试地址：",prop:"prePublishUrl"}},[i("el-input",{attrs:{maxlength:"100",placeholder:"请填写预发布url"},model:{value:t.form.prePublishUrl,callback:function(e){t.$set(t.form,"prePublishUrl",e)},expression:"form.prePublishUrl"}})],1),i("el-form-item",{attrs:{label:"设置访问白名单：",prop:"preTestUser"}},[i("el-checkbox-group",{staticClass:"label",model:{value:t.form.preTestUser,callback:function(e){t.$set(t.form,"preTestUser",e)},expression:"form.preTestUser"}},[i("el-checkbox",{attrs:{label:"1"}},[t._v("欣网")]),i("el-checkbox",{attrs:{label:"2"}},[t._v("美洲")]),i("el-checkbox",{attrs:{label:"3"}},[t._v("全部")])],1)],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("div",{staticClass:"btn-orange-primary",on:{click:function(e){return t.changeRelease("pre")}}},[i("p",[t._v("提交")])])])],1)],1)},s=[],n=i("6cac"),r=i("d95f"),c=i("0d83"),o=i("0b9a"),l=i("0993"),u=i("7aae"),h={queryList:function(){},pageActivityList:function(t){},activityDelete:function(t){},saveActivity:function(t){return new Promise((function(e){u["a"].HttpPost(l["c"].saveActivity,t,(function(t){Object(l["a"])(t)&&e(t)}))}))},changeActivityStatus:function(t){return new Promise((function(e){u["a"].HttpPost(l["c"].changeActivityStatus,t,(function(t){Object(l["a"])(t)&&e(t)}))}))}},p=i("0948");function g(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function d(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?g(i,!0).forEach((function(e){f(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):g(i).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function f(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var v={components:{iPageTitle:n["a"],ActivePop:o["a"],TitleTab:c["a"],pictureTable:r["a"]},data:function(){return{batchSelect:!1,autoReleaseDialog:!1,preReleaseDialog:!1,waitAuditCount:0,disabledList:[],dateRange:[],allActivity:[],bigImgSrc:"",bigImgShow:!1,statusList:p["a"].activityStatusNew,ActiveList:[{activityStatus:1,isSelect:!1},{activityStatus:1,isSelect:!1},{activityStatus:1,isSelect:!1},{activityStatus:1,isSelect:!1},{activityStatus:1,isSelect:!1},{activityStatus:1,isSelect:!1}],isDeleteVisible:!1,pagination:{id:"",startTime:"",startTimeEnd:"",activityStatus:"",pageNum:1,pageSize:8,total:0},selectActivity:{},form:{preTestUser:[],prePublishUrl:""},roles:{prePublishUrl:[{required:!0,message:"请输入活动标签",trigger:"blur"}],preTestUser:[{required:!0,message:"请输入活动名称",trigger:"blur"}]}}},computed:{totalNum:function(){return Math.ceil(this.pagination.total/this.pagination.pageSize)},activityDetail:function(){return this.$store.getters.activityDetail},cancelShow:function(){return!0}},watch:{dateRange:function(){if(this.dateRange&&this.dateRange.length>0){var t=this.dateRange[0]+" 00:00:00",e=this.dateRange[1]+" 11:59:59";this.pagination.startTime=t,this.pagination.endTime=e}else this.pagination.startTime="",this.pagination.endTime=""}},created:function(){void 0!==this.$route.query.activityStatus&&(this.pagination.activityStatus=this.$route.query.activityStatus)},mounted:function(){},methods:{createAction:function(){this.batchSelect=!this.batchSelect},queryList:function(){},cleanSearch:function(){Object.assign(this.$data.pagination,this.$options.data().pagination),this.dateRange=[],this.getTemplateActiveList()},handleTableChange:function(t){this.pagination=t,this.getTemplateActiveList()},searchBtnFunc:function(){this.pagination=d({},this.pagination,{pageNum:1,pageSize:8,total:0}),this.getTemplateActiveList()},selectStatus:function(t){this.dateRange=[],this.pagination=d({},this.pagination,{id:"",startTime:"",startTimeEnd:"",activityStatus:t,pageNum:1,pageSize:8,total:0}),this.getTemplateActiveList()},deleteHistory:function(){this.$router.push({name:"editProject"})},deleteActive:function(t){var e=this;h.activityDelete(t).then((function(t){200==t.code&&(e.pagination=d({},e.pagination,{pageNum:1,pageSize:8,total:0}),e.getTemplateActiveList(),e.$message({type:"info",message:"刪除成功"}))}))},deleteCurrent:function(t){var e=this;this.$confirm("确定后将永久删除该活动","确认删除该活动吗？",{distinguishCancelAndClose:!0,customClass:"confirm subText",center:!0}).then((function(){e.deleteActive(t)}))},editAction:function(){this.$router.push({name:"editProject"})},editOrRead:function(t){this.$store.dispatch("set_activity_detail",d({},t)),this.$router.push({name:"activityInfo"})},viewConfig:function(t){this.$router.push({path:"/app/editor/".concat(t.id)})},getTemplateActiveList:function(){var t=this;this.ActiveList=[],h.pageActivityList(this.pagination).then((function(e){e&&e.data&&(t.ActiveList=e.data.list,t.waitAuditCount=e.data.waitAuditCount,t.pagination.total=e.data.total||0)}))},bigImg:function(t){this.bigImgSrc=t,this.bigImgShow=!0},handleActiveDisabled:function(t){var e=[];switch(t){case-1:e=[7,8,10,11,12];break;case 0:e=[6,7,8,9,11,12];break;case 1:e=[6,9,10,11];break;case 2:e=[6,9,10,11,12];break;case 3:e=[6,7,8,9,10,11,12];break;case 4:e=[6,7,8,9,10,11,12];break;case 5:e=[6,7,8,9,10,11,12];break;default:e=[6,7,8,9,10,11,12]}return e},previewActive:function(t){},otherAction:function(t){var e=this;switch(Number(t.index)){case 7:this.$confirm("发布活动后，正式链接将立即生效，用户可直接参与此活动","确认发布该活动吗？",{distinguishCancelAndClose:!0,customClass:"confirm subText",center:!0}).then((function(){e.changeStauts({id:t.data.id,activityStatus:3})}));break;case 8:this.preReleaseDialog=!0,this.selectActivity=JSON.parse(JSON.stringify(t.data));break;case 9:this.changeStauts({id:t.data.id,activityStatus:0});break;case 10:this.changeStauts({id:t.data.id,activityStatus:1});break;case 11:this.changeStauts({id:t.data.id,activityStatus:2});break;case 12:this.changeStauts({id:t.data.id,activityStatus:-1});break}},changeStauts:function(t){var e=this;h.changeActivityStatus(t).then((function(t){e.getTemplateActiveList(),e.$message.info("提交状态成功")}))},changeRelease:function(t){var e=this,i=JSON.parse(JSON.stringify(this.selectActivity)),a=[i.startTime,i.endTime],s=[i.rcvStartTime,i.rcvEndTime],n=this.handleDateRange(a);i.startTime=n.startTime,i.endTime=n.endTime;var r=this.handleDateRange(s);i.rcvStartTime=r.startTime,i.rcvEndTime=r.endTime,"pre"===t?this.$refs["form"].validate((function(t){if(!t)return e.$message.error("表单填写有误，请检查是否有错"),!1;i.prePublishType=1,i.prePublishUrl=e.form.prePublishUrl,i.preTestUser=e.form.preTestUser,h.saveActivity(i).then((function(t){t.data&&(e.$message.info("提交成功"),e.preReleaseDialog=!1)}))})):"auto"===t&&(i.prePublishType=0,h.saveActivity(i).then((function(t){t.data&&(e.$message.info("提交成功"),e.autoReleaseDialog=!1)})))},handleDateRange:function(t){var e={};if(t&&t.length>0){var i=t[0],a=t[1];e.startTime=momentTimezone.tz(i,"America/New_York").valueOf(),e.endTime=momentTimezone.tz(a,"America/New_York").valueOf()}else e.startTime="",e.endTime="";return e}}},m=v,b=(i("0ad8"),i("2877")),y=Object(b["a"])(m,a,s,!1,null,null,null);e["default"]=y.exports},9066:function(t,e,i){}}]);