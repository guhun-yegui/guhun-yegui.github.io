<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>批量注册局部组件 | 孤魂野鬼</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="批量注册局部组件">
    
    <link rel="preload" href="/assets/css/0.styles.487d089c.css" as="style"><link rel="preload" href="/assets/js/app.e12dc485.js" as="script"><link rel="preload" href="/assets/js/44.8b11d416.js" as="script"><link rel="prefetch" href="/assets/js/10.41fee028.js"><link rel="prefetch" href="/assets/js/11.5bcc5239.js"><link rel="prefetch" href="/assets/js/12.06b4bbd6.js"><link rel="prefetch" href="/assets/js/13.51f46ed7.js"><link rel="prefetch" href="/assets/js/14.1c96754f.js"><link rel="prefetch" href="/assets/js/15.b43bae40.js"><link rel="prefetch" href="/assets/js/16.1b0a7f57.js"><link rel="prefetch" href="/assets/js/17.249b5f01.js"><link rel="prefetch" href="/assets/js/18.f15e4fb8.js"><link rel="prefetch" href="/assets/js/19.59f41660.js"><link rel="prefetch" href="/assets/js/2.e92a7aba.js"><link rel="prefetch" href="/assets/js/20.694cb51a.js"><link rel="prefetch" href="/assets/js/21.10f25dfb.js"><link rel="prefetch" href="/assets/js/22.9f688297.js"><link rel="prefetch" href="/assets/js/23.37e07c36.js"><link rel="prefetch" href="/assets/js/24.56d7efc8.js"><link rel="prefetch" href="/assets/js/25.f0c6bd1a.js"><link rel="prefetch" href="/assets/js/26.b62c9b45.js"><link rel="prefetch" href="/assets/js/27.a82399e3.js"><link rel="prefetch" href="/assets/js/28.6a37af2e.js"><link rel="prefetch" href="/assets/js/29.29858bc4.js"><link rel="prefetch" href="/assets/js/3.4a216758.js"><link rel="prefetch" href="/assets/js/30.c0c7f9a4.js"><link rel="prefetch" href="/assets/js/31.dcebaa98.js"><link rel="prefetch" href="/assets/js/32.08479217.js"><link rel="prefetch" href="/assets/js/33.9aaf4692.js"><link rel="prefetch" href="/assets/js/34.ddc35a9f.js"><link rel="prefetch" href="/assets/js/35.3e919117.js"><link rel="prefetch" href="/assets/js/36.ffbe82a0.js"><link rel="prefetch" href="/assets/js/37.c9bdbd42.js"><link rel="prefetch" href="/assets/js/38.2844b688.js"><link rel="prefetch" href="/assets/js/39.a23d877f.js"><link rel="prefetch" href="/assets/js/4.498c4dda.js"><link rel="prefetch" href="/assets/js/40.45682a27.js"><link rel="prefetch" href="/assets/js/41.5d3ea473.js"><link rel="prefetch" href="/assets/js/42.e8f93fbb.js"><link rel="prefetch" href="/assets/js/43.2d0480c1.js"><link rel="prefetch" href="/assets/js/45.6c8ee91a.js"><link rel="prefetch" href="/assets/js/46.8036563f.js"><link rel="prefetch" href="/assets/js/47.c605d109.js"><link rel="prefetch" href="/assets/js/48.e28e3d36.js"><link rel="prefetch" href="/assets/js/5.6a3f21c1.js"><link rel="prefetch" href="/assets/js/6.200298ef.js"><link rel="prefetch" href="/assets/js/7.4f5f5571.js"><link rel="prefetch" href="/assets/js/8.6c17081d.js"><link rel="prefetch" href="/assets/js/9.b4a5ba9a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.487d089c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><section id="global-layout" data-v-98a81704><header class="header" data-v-597182b5 data-v-98a81704><div class="header-navbar" data-v-597182b5><div class="flex-xbc main header-nav" data-v-597182b5><div class="nav-link" data-v-597182b5><a href="/" class="inblock link-logo router-link-active" data-v-597182b5><img data-src="/111.jpeg" loading="lazy" alt="logo" class="logo-img lazy" data-v-597182b5></a> <nav class="link-list" data-v-597182b5><a href="/" class="list-item router-link-active" data-v-597182b5>主页</a><a href="/posts/" class="list-item router-link-active" data-v-597182b5>博客</a><a href="/jishu/" class="list-item" data-v-597182b5>技术</a><a href="/tag/" class="list-item" data-v-597182b5>标签</a></nav></div> <div class="search-box" data-v-597182b5><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <div class="login-content" data-v-597182b5><span data-v-597182b5>登陆</span> <span data-v-597182b5>/ 注册</span></div> <div data-v-597182b5><div data-v-597182b5></div></div></div></div> </header> <!----> <section class="page" data-v-98a81704 data-v-98a81704><section class="info no-bg" data-v-77ce606b><article class="main info-content" data-v-09525e5c data-v-77ce606b><div class="content-header" data-v-09525e5c><h1 class="header-title" data-v-09525e5c>批量注册局部组件</h1></div> <div class="flex-wcc content-tag" data-v-09525e5c><div class="inblock tag-list" data-v-09525e5c><a href="/category/经验/" class="tag-text" data-v-09525e5c>经验
      </a></div> <span class="tag-space" data-v-09525e5c>/</span> <div class="inblock tag-list" data-v-09525e5c><a href="/tag/vue/" class="tag-text" data-v-09525e5c>vue
      </a></div></div> <div class="content content__default" data-v-09525e5c><blockquote><p>在做动态表单或者某些组件化的业务时，会自定义大量组件。如何批量注册和使用</p></blockquote> <blockquote><p>利用 require.context 读取文件, 形成列表，直接全部放进 component 里。然后用 component 动态组件去挂载</p></blockquote> <p>require.context()方法是 webpack 的一个 api，主要功能是自动导入文件，当导入文件过多时，使用该方法可以统一导入，避免导入不同文件时多行书导入语句，该函数接受三个参数，参数说明如下：
require.context(path, isTraverseSubfolders, regExp)</p> <p>path: String 类型，读取文件的路径.
isTraverseSubfolders：Boolean 类型，是否遍历文件的子目录
regExp：RegExp 类型，匹配文件的正则</p> <p>文件目录</p> <ul><li><p>src</p> <ul><li><p>formComponents</p> <ul><li>Input //组件</li></ul></li></ul> <p>index.vue</p> <p>index.js</p></li> <li><p>下面是注册完之后在一个组件内用的情况</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//index.js</span>
<span class="token comment">//读取匹配所有formComponents的vue组件，名字前面加上form，然后全部导出</span>
<span class="token keyword">const</span> files <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'./formComponents'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.vue$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>
<span class="token keyword">const</span> switchList <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
files<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  switchList<span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">form</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'.vue'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.\/</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">files</span><span class="token punctuation">(</span>
    key
  <span class="token punctuation">)</span><span class="token punctuation">.</span>default
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>switchList
<span class="token punctuation">}</span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 使用注册好的组件，也可以用动态组件去动态使用 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form-input</span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token comment">//导入打包好的组件</span>
  <span class="token keyword">import</span> components <span class="token keyword">from</span> <span class="token string">'./dynamicForm'</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token comment">//全部注册</span>
    components<span class="token operator">:</span> components<span class="token punctuation">,</span>
    props<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'components'</span><span class="token punctuation">,</span> components<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    methods<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>下面是注册全局组件，所有组件内都能直接使用的</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">const</span> files <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'./'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.vue$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">components</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  files<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'.vue'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.\/</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      <span class="token function">files</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span>default
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> components
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token function">components</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></div> <div class="content-time" data-v-09525e5c><time datetime="2019 M09 21" class="time-text" data-v-09525e5c>Create Time: 2019 M09 21
    </time> <time datetime="2022 M02 24" class="time-text" data-v-09525e5c>Last Updated: 2022 M02 24
    </time></div></article> <section class="flex-xb main info-nav" data-v-203269c1 data-v-77ce606b><a href="/posts/%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92.html" class="flex-xb nav-item" data-v-203269c1><div class="flex-xcc item-img" data-v-203269c1><img data-src="https://picsum.photos/536/354?random&amp;date=2021-04-12" loading="lazy" alt="学习计划" class="img lazy" data-v-203269c1></div> <article class="flex-ysc item-content" data-v-203269c1><h2 class="content-title" data-v-203269c1>学习计划</h2> <div class="content" data-v-203269c1></div></article></a> <a href="/posts/%E7%AC%94%E8%AE%B0.html" class="flex-xb nav-item" data-v-203269c1><div class="flex-xcc item-img" data-v-203269c1><img data-src="https://picsum.photos/536/354?random&amp;date=2021-04-12" loading="lazy" alt="前端笔记" class="img lazy" data-v-203269c1></div> <article class="flex-ysc item-content" data-v-203269c1><h2 class="content-title" data-v-203269c1>前端笔记</h2> <div class="content" data-v-203269c1></div></article></a></section> <!----></section></section> <footer class="footer" data-v-109158d8 data-v-98a81704><nav class="link-list" data-v-109158d8><a href="https://github.com/guhun-yegui" target="_blank" rel="noopener noreferrer" class="list-item" data-v-109158d8>Github</a></nav></footer></section><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.e12dc485.js" defer></script><script src="/assets/js/44.8b11d416.js" defer></script>
  </body>
</html>
